# 陪你App - 功能点规划 V1.5

**状态**: 规划中  
**日期**: 2026-01-24  
**版本**: V1.5  

---

## 0. 修复与体验优化 (Fixes & Optimizations)

| ID | 修复项 | 问题描述 | 预期效果 | 优先级 |
| :--- | :--- | :--- | :--- | :--- |
| **FIX-001** | **用户隐私保护** | 客户端目前显示地陪真实姓名 (`name`)，存在隐私风险。 | 地陪列表/详情页改为显示 **用户昵称** (`nickname`)。 | **P0** | **Completed** |
| **FIX-002** | **地陪管理入口修复** | "个人中心" -> "管理地陪资料" 按钮点击无反应。 | 修复路由跳转，确保能正确进入编辑页。 | **P0** | **Completed** (via Data Fix) |
| **FIX-003** | **后台UI样式修复** | 后台管理部分文字在白色背景下显示为白色，无法阅读。 | 修正文字/背景对比度，适配亮色模式。 | **P1** | **Completed** |
| **FIX-004** | **定制单校验松绑** | 定制需求内容存在字数限制，影响体验。 | 移除最小字数限制，改为非空即可。 | **P1** | **Completed** |
| **FIX-005** | **数据一致性修复** | 部分用户标记为地陪但无记录，导致入口报错。 | 修复孤儿数据，重置异常状态。 | **P0** | **Completed** |

---

## 1. 功能增强 (Enhancements)

| ID | 功能名称 | 需求描述 | 状态 | 优先级 |
| :--- | :--- | :--- | :--- | :--- |
| **ENH-001** | **地陪城市筛选** | 列表页增加按城市筛选功能。 | 前端复用 `CitySelector` 组件，支持关键词搜索和热门城市选择。暂不实现无限滚动。 | **P1** | **Completed** |
| **ENH-002** | **后台订单搜索** | 订单列表缺乏搜索能力。 | 后端增加 `keyword` 筛选 (订单号/手机号)；前端增加搜索框。 | **P1** | **Completed** |

---

## 2. 核心特性 (Core Features)

| ID | 功能名称 | 需求描述 | 状态 | 优先级 |
| :--- | :--- | :--- | :--- | :--- |
| **FEAT-004** | **订单模型升级** | 优化下单体验，支持腾讯地图选点与精准时间选择。 | **开发中** | **P1** |

---

## 3. 详细需求分析 (Detailed Analysis)

### 3.1 [FEAT-004] 订单模型升级 (Order Upgrade)

#### 1. 数据库变更 (Schema Changes)
- **表**: `orders`
- **变更**:
  - `service_date` (Date) -> **`service_start_time`** (DateTime): 精确记录服务开始的日期和时间。
  - **新增** `duration` (Int): 服务时长 (小时)，默认 8。
  - **新增** `service_lat` (Decimal 10,6): 服务地点纬度。
  - **新增** `service_lng` (Decimal 10,6): 服务地点经度。
  - **新增** `service_address` (Varchar 255): 服务地点文本描述。

#### 2. 前端交互 (Order Create)
- **地图选点**:
  - 集成 **腾讯地图 (Tencent Map)**。
  - 交互: 点击地图图标 -> 弹窗显示地图 -> 拖拽/点击选点 -> 自动回填地址文本。
- **时间选择**:
  - 替换原有日期选择器，使用 **日期+时间** 组合组件。
- **时长选择**:
  - 新增数字输入/下拉框，步长 1h，默认 8h。

#### 3. 后端逻辑
- **校验**: 更新 Zod Schema，适配新的时间字段和时长校验，验证 lat/lng 格式。
- **兼容**: 确保旧数据 (如有) 不会导致报错。
