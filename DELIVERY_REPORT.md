# åœ°é™ªåº”ç”¨åç«¯ - FP-001~FP-004 äº¤ä»˜æŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

**é¡¹ç›®åç§°**: åœ°é™ªåº”ç”¨åç«¯  
**æŠ€æœ¯æ ˆ**: TypeScript + Express.js + MySQL  
**å¼€å‘å‘¨æœŸ**: FP-001 ~ FP-004  
**GitHubä»“åº“**: https://github.com/zyhazwraith/gepei-backend  
**äº¤ä»˜æ—¥æœŸ**: 2026-01-19

---

## âœ… å·²å®ŒæˆåŠŸèƒ½ç‚¹

### FP-001: é¡¹ç›®åˆå§‹åŒ–ä¸ç¯å¢ƒé…ç½®
**å®Œæˆæ—¶é—´**: 2026-01-19  
**Gitåˆ†æ”¯**: feature/FP-001 â†’ main

**äº¤ä»˜å†…å®¹**:
- âœ… å®Œæ•´çš„TypeScript + Expressé¡¹ç›®ç»“æ„
- âœ… MySQLæ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼ˆ9ä¸ªè¡¨ï¼‰
- âœ… JWTè®¤è¯ç³»ç»Ÿé…ç½®
- âœ… é”™è¯¯å¤„ç†ç³»ç»Ÿ
- âœ… åŸºç¡€APIæ¡†æ¶
- âœ… å¼€å‘ç¯å¢ƒé…ç½®

**æ ¸å¿ƒæ–‡ä»¶**:
```
src/
â”œâ”€â”€ config/database.ts          # æ•°æ®åº“é…ç½®
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ errors.ts               # é”™è¯¯å¤„ç†ç±»
â”‚   â”œâ”€â”€ jwt.ts                  # JWTå·¥å…·
â”‚   â””â”€â”€ validation.ts           # éªŒè¯å·¥å…·
â”œâ”€â”€ middleware/errorHandler.ts  # é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”œâ”€â”€ app.ts                      # Expressåº”ç”¨
â””â”€â”€ server.ts                   # æœåŠ¡å™¨å¯åŠ¨
database/init.sql               # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
```

---

### FP-002: ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
**å®Œæˆæ—¶é—´**: 2026-01-19  
**Gitåˆ†æ”¯**: feature/FP-002 â†’ main

**APIç«¯ç‚¹**:
```
POST /api/auth/register
```

**è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "phone": "13800138000",
  "password": "test123",
  "nickname": "æµ‹è¯•ç”¨æˆ·"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "user": {
      "id": 1,
      "phone": "13800138000",
      "nickname": "æµ‹è¯•ç”¨æˆ·",
      "avatar_url": null,
      "is_guide": 0,
      "balance": "0.00"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… æ‰‹æœºå·æ ¼å¼éªŒè¯ï¼ˆä¸­å›½å¤§é™†11ä½ï¼‰
- âœ… å¯†ç å¼ºåº¦éªŒè¯ï¼ˆ6-20ä½ï¼‰
- âœ… æ‰‹æœºå·å”¯ä¸€æ€§æ£€æŸ¥
- âœ… å¯†ç bcryptåŠ å¯†ï¼ˆ12è½®ï¼‰
- âœ… è‡ªåŠ¨ç”ŸæˆJWT Token
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†

**æ ¸å¿ƒæ–‡ä»¶**:
```
src/
â”œâ”€â”€ models/user.model.ts         # ç”¨æˆ·æ•°æ®æ¨¡å‹
â”œâ”€â”€ controllers/auth.controller.ts  # è®¤è¯æ§åˆ¶å™¨
â””â”€â”€ routes/auth.routes.ts        # è®¤è¯è·¯ç”±
```

---

### FP-003: ç”¨æˆ·ç™»å½•åŠŸèƒ½
**å®Œæˆæ—¶é—´**: 2026-01-19  
**Gitåˆ†æ”¯**: feature/FP-003 â†’ main

**APIç«¯ç‚¹**:
```
POST /api/auth/login
```

**è¯·æ±‚ç¤ºä¾‹**:
```json
{
  "phone": "13800138000",
  "password": "test123"
}
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "user": {
      "id": 1,
      "phone": "13800138000",
      "nickname": "æµ‹è¯•ç”¨æˆ·",
      "avatar_url": null,
      "is_guide": 0,
      "balance": "0.00"
    },
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}
```

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… æ‰‹æœºå·+å¯†ç ç™»å½•
- âœ… bcryptå¯†ç éªŒè¯
- âœ… ç™»å½•æˆåŠŸè¿”å›JWT Token
- âœ… ç»Ÿä¸€çš„é”™è¯¯æç¤ºï¼ˆé˜²æ­¢ç”¨æˆ·æšä¸¾ï¼‰
- âœ… å®Œæ•´çš„è¾“å…¥éªŒè¯

---

### FP-004: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
**å®Œæˆæ—¶é—´**: 2026-01-19  
**Gitåˆ†æ”¯**: feature/FP-004 â†’ main

**APIç«¯ç‚¹**:
```
GET /api/auth/me
```

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <token>
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "user": {
      "id": 1,
      "phone": "13800138000",
      "nickname": "æµ‹è¯•ç”¨æˆ·",
      "avatar_url": null,
      "is_guide": 0,
      "balance": "0.00"
    }
  }
}
```

**åŠŸèƒ½ç‰¹æ€§**:
- âœ… JWT TokenéªŒè¯
- âœ… Bearer Tokenè®¤è¯
- âœ… è®¤è¯ä¸­é—´ä»¶
- âœ… ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢
- âœ… å®Œæ•´çš„TokenéªŒè¯å’Œé”™è¯¯å¤„ç†

**æ ¸å¿ƒæ–‡ä»¶**:
```
src/middleware/auth.middleware.ts  # è®¤è¯ä¸­é—´ä»¶
```

---

## ğŸ“Š APIæ–‡æ¡£æ€»è§ˆ

| ç«¯ç‚¹ | æ–¹æ³• | è®¤è¯ | æè¿° |
|------|------|------|------|
| `/health` | GET | âŒ | å¥åº·æ£€æŸ¥ |
| `/api/auth/register` | POST | âŒ | ç”¨æˆ·æ³¨å†Œ |
| `/api/auth/login` | POST | âŒ | ç”¨æˆ·ç™»å½• |
| `/api/auth/me` | GET | âœ… | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

**å·²åˆ›å»ºçš„è¡¨**ï¼ˆ9ä¸ªï¼‰:
1. `users` - ç”¨æˆ·è¡¨
2. `guides` - åœ°é™ªèµ„æ–™è¡¨
3. `orders` - è®¢å•è¡¨
4. `payments` - æ”¯ä»˜è®°å½•è¡¨
5. `withdrawals` - æç°è®°å½•è¡¨
6. `custom_requirements` - å®šåˆ¶éœ€æ±‚è¡¨
7. `custom_order_candidates` - å®šåˆ¶è®¢å•å€™é€‰è¡¨
8. `reviews` - è¯„ä»·è¡¨
9. `admin_logs` - ç®¡ç†å‘˜æ“ä½œæ—¥å¿—è¡¨

**åˆå§‹åŒ–è„šæœ¬**: `database/init.sql`

---

## ğŸ” å®‰å…¨ç‰¹æ€§

- âœ… å¯†ç bcryptåŠ å¯†ï¼ˆ12è½®ï¼‰
- âœ… JWT Tokenè®¤è¯ï¼ˆ7å¤©æœ‰æ•ˆæœŸï¼‰
- âœ… Bearer TokenéªŒè¯
- âœ… ç»Ÿä¸€é”™è¯¯æç¤ºï¼ˆé˜²æ­¢ä¿¡æ¯æ³„éœ²ï¼‰
- âœ… è¾“å…¥éªŒè¯å’Œæ¸…æ´—
- âœ… SQLæ³¨å…¥é˜²æŠ¤ï¼ˆå‚æ•°åŒ–æŸ¥è¯¢ï¼‰

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### ç”¨æˆ·æ³¨å†Œæµ‹è¯•
```bash
# æˆåŠŸæ³¨å†Œ
âœ… POST /api/auth/register - 201 Created

# é‡å¤æ³¨å†Œ
âœ… è¿”å›é”™è¯¯: "è¯¥æ‰‹æœºå·å·²æ³¨å†Œ"

# æ ¼å¼é”™è¯¯
âœ… è¿”å›é”™è¯¯: "æ‰‹æœºå·æ ¼å¼ä¸æ­£ç¡®"
```

### ç”¨æˆ·ç™»å½•æµ‹è¯•
```bash
# æˆåŠŸç™»å½•
âœ… POST /api/auth/login - 200 OK

# å¯†ç é”™è¯¯
âœ… è¿”å›é”™è¯¯: "æ‰‹æœºå·æˆ–å¯†ç é”™è¯¯"

# ç”¨æˆ·ä¸å­˜åœ¨
âœ… è¿”å›é”™è¯¯: "æ‰‹æœºå·æˆ–å¯†ç é”™è¯¯"
```

### è·å–ç”¨æˆ·ä¿¡æ¯æµ‹è¯•
```bash
# å¸¦æœ‰æ•ˆToken
âœ… GET /api/auth/me - 200 OK

# æ— Token
âœ… è¿”å›é”™è¯¯: "æœªæä¾›è®¤è¯Token"

# æ— æ•ˆToken
âœ… è¿”å›é”™è¯¯: "Tokenæ— æ•ˆ"
```

---

## ğŸ“¦ é¡¹ç›®ç»“æ„

```
gepei-backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ database.ts          # æ•°æ®åº“é…ç½®
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â””â”€â”€ auth.controller.ts   # è®¤è¯æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ middleware/
â”‚   â”‚   â”œâ”€â”€ auth.middleware.ts   # è®¤è¯ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ errorHandler.ts      # é”™è¯¯å¤„ç†ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ user.model.ts        # ç”¨æˆ·æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â””â”€â”€ auth.routes.ts       # è®¤è¯è·¯ç”±
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ index.ts             # TypeScriptç±»å‹å®šä¹‰
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ errors.ts            # é”™è¯¯å¤„ç†ç±»
â”‚   â”‚   â”œâ”€â”€ jwt.ts               # JWTå·¥å…·
â”‚   â”‚   â””â”€â”€ validation.ts        # éªŒè¯å·¥å…·
â”‚   â”œâ”€â”€ app.ts                   # Expressåº”ç”¨é…ç½®
â”‚   â””â”€â”€ server.ts                # æœåŠ¡å™¨å¯åŠ¨æ–‡ä»¶
â”œâ”€â”€ database/
â”‚   â””â”€â”€ init.sql                 # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ dist/                        # ç¼–è¯‘è¾“å‡ºç›®å½•
â”œâ”€â”€ node_modules/                # ä¾èµ–åŒ…
â”œâ”€â”€ package.json                 # é¡¹ç›®é…ç½®
â”œâ”€â”€ tsconfig.json                # TypeScripté…ç½®
â”œâ”€â”€ .gitignore                   # Gitå¿½ç•¥é…ç½®
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â””â”€â”€ TODO.md                      # ä»»åŠ¡æ¸…å•
```

---

## ğŸš€ éƒ¨ç½²è¯´æ˜

### ç¯å¢ƒè¦æ±‚
- Node.js >= 18.0.0
- MySQL >= 8.0
- npm >= 9.0.0

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**
```bash
git clone https://github.com/zyhazwraith/gepei-backend.git
cd gepei-backend
```

2. **å®‰è£…ä¾èµ–**
```bash
npm install
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
åˆ›å»º `.env` æ–‡ä»¶ï¼ˆå‚è€ƒ `.env.example`ï¼‰:
```env
PORT=3000
NODE_ENV=production
DB_HOST=your_db_host
DB_PORT=3306
DB_USER=your_db_user
DB_PASSWORD=your_db_password
DB_NAME=gepei_db
JWT_SECRET=your_jwt_secret
JWT_EXPIRES_IN=7d
CORS_ORIGIN=https://your-frontend-domain.com
```

4. **åˆå§‹åŒ–æ•°æ®åº“**
```bash
mysql -u root -p < database/init.sql
```

5. **ç¼–è¯‘é¡¹ç›®**
```bash
npm run build
```

6. **å¯åŠ¨æœåŠ¡**
```bash
# ç”Ÿäº§ç¯å¢ƒ
npm start

# å¼€å‘ç¯å¢ƒ
npm run dev
```

---

## ğŸ“ Gitæäº¤å†å²

```
* c1920de (main) Merge branch 'feature/FP-004' into main
|\  
| * 641ae4e (feature/FP-004) feat(FP-004): å®ç°è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯åŠŸèƒ½
|/  
* 0f90eed Merge branch 'feature/FP-003' into main
|\  
| * a174d63 (feature/FP-003) feat(FP-003): å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½
|/  
* 7804e2f Merge branch 'feature/FP-002' into main
|\  
| * c7060ec (feature/FP-002) feat(FP-002): å®ç°ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
|/  
* 8099cb1 Merge branch 'feature/FP-001' into main
|\  
| * 01ad507 (feature/FP-001) fix: ä¿®å¤JWTç±»å‹é”™è¯¯
|/  
* ae8039c feat(FP-001): é¡¹ç›®åˆå§‹åŒ–ä¸ç¯å¢ƒé…ç½®
```

---

## ğŸ“Œ ä¸‹ä¸€æ­¥è®¡åˆ’

æ ¹æ®åŠŸèƒ½ç‚¹å¼€å‘ä»»åŠ¡æ–‡æ¡£ï¼Œåç»­éœ€è¦å¼€å‘çš„åŠŸèƒ½ç‚¹ï¼š

- **FP-005**: åœ°é™ªè®¤è¯ï¼ˆéªŒè¯èº«ä»½è¯+æäº¤èµ„æ–™ï¼‰
- **FP-006**: åœ°é™ªèµ„æ–™ç¼–è¾‘
- **FP-007**: åœ°é™ªåˆ—è¡¨æŸ¥è¯¢
- **FP-008**: åœ°é™ªè¯¦æƒ…æŸ¥è¯¢
- **FP-009**: è®¢å•åˆ›å»º
- **FP-010**: è®¢å•ç®¡ç†
- **FP-011**: ç®¡ç†å‘˜ç™»å½•
- **FP-012**: ç®¡ç†å‘˜åŠŸèƒ½

---

## ğŸ“ è”ç³»æ–¹å¼

- **GitHub**: https://github.com/zyhazwraith/gepei-backend
- **é¡¹ç›®æ–‡æ¡£**: `/home/ubuntu/gepei_tech_docs/`

---

## âœ¨ æ€»ç»“

æœ¬æ¬¡äº¤ä»˜å®Œæˆäº†åœ°é™ªåº”ç”¨åç«¯çš„**åŸºç¡€è®¤è¯æ¨¡å—**ï¼ˆFP-001~FP-004ï¼‰ï¼ŒåŒ…æ‹¬ï¼š
- âœ… å®Œæ•´çš„é¡¹ç›®æ¶æ„
- âœ… ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½
- âœ… ç”¨æˆ·ç™»å½•åŠŸèƒ½
- âœ… ç”¨æˆ·ä¿¡æ¯æŸ¥è¯¢åŠŸèƒ½
- âœ… JWTè®¤è¯ç³»ç»Ÿ
- âœ… å®Œæ•´çš„é”™è¯¯å¤„ç†
- âœ… æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

æ‰€æœ‰åŠŸèƒ½å‡å·²é€šè¿‡æµ‹è¯•ï¼Œä»£ç å·²æ¨é€åˆ°GitHubï¼Œå¯ä»¥è¿›å…¥ä¸‹ä¸€é˜¶æ®µçš„å¼€å‘ã€‚

---

**äº¤ä»˜çŠ¶æ€**: âœ… å·²å®Œæˆ  
**ä»£ç è´¨é‡**: âœ… é€šè¿‡  
**åŠŸèƒ½æµ‹è¯•**: âœ… é€šè¿‡  
**æ–‡æ¡£å®Œæ•´æ€§**: âœ… å®Œæ•´

